"use strict";function Test(t){function e(t,e,n,o){var r=!1;return function(){return(arguments.length<=0?void 0:arguments[0])!==i&&(o&&n.apply(void 0,arguments),r=!0),{called:r,obj:t,fn:e,origFunction:n}}}function n(e){var n={};return n.to=function(n){Promise.resolve(e).then(function(e){Test.prototype.showResult(t,n,e,o)})},n.toBe=n.to,n.toHave=n.to,n.is=n.to,n.equals=n.to,n.toHaveBeenCalled=function(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Promise.resolve(e).then(function(e){e=e(i),Test.prototype.showResult(t,e.called,n,o),e.obj[e.fn]=e.origFunction})},n.notToHaveBeenCalled=function(){n.toHaveBeenCalled(!1)},n}var o,r={},i=Symbol("FAKE_CALL");return r.observe=function(t,n){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t[n]=new e(t,n,t[n],o),r},r.using=function(t){return o=t,r},r.do=function(t){return"function"==typeof t&&t(),r},r.expect=function(t){return new n(t)},r.assert=r.expect,r}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};if(Test.ValidationFunction={EQUALS:function(t,e){return t===e},NOT_EQUALS:function(t,e){return t!==e},CONTAINS:function(t,e){return!!~e.indexOf(t)},ARRAY_SHALLOW:function(t,e){var n=t.length;if(e.length!==n)return!1;for(;n--;)if(e[n]!==t[n])return!1;return!0},OBJECT_DEEP:function(t,e){if(null==t||null==e)return t===e;if(t.constructor!==e.constructor)return!1;if(t instanceof Function)return t===e;if(t instanceof RegExp)return t===e;if(t===e||t.valueOf()===e.valueOf())return!0;if(Array.isArray(t)&&t.length!==e.length)return!1;if(t instanceof Date)return!1;if(!(t instanceof Object))return!1;if(!(e instanceof Object))return!1;var n=Object.keys(t);return Object.keys(e).every(function(t){return~n.indexOf(t)})&&n.every(function(n){return Test.ValidationFunction.OBJECT_DEEP(t[n],e[n])})}},Test.Console={CONSOLE:Symbol("console"),TERMINAL:Symbol("terminal")},Test.prototype.output=null,Test.prototype.hidePassed=!1,Test.prototype.colorMethod=Test.Console.CONSOLE,Test.prototype.showResult=function(t,e,n,o){var r=Test.prototype.createResult(t,e,n,o||Test.ValidationFunction.EQUALS);if(null!==r)if(Test.prototype.output)Test.prototype.output.appendChild(r.result);else if(Test.prototype.colorMethod===Test.Console.CONSOLE)console.log("%c"+r.result,"\n\t\t\t\tcolor: "+r.bgColor+";\n\t\t\t\ttext-shadow: 0 0 1px rgba(0, 0, 0, .2);\n\t\t\t\t"+(r.passed?"":"font-size: 150%; font-weight: bold;")+"\n\t\t\t");else{var i={};r.passed?(i.bg="[49m",i.fg="[92m"):(i.bg="[101m",i.fg="[93m"),console.log(""+i.bg+i.fg+r.result+"[0m")}},Test.prototype.getResult=function(t,e,n){return t.call(void 0,e,n)},Test.prototype.createResult=function(t,e,n,o){var r=function(t){return"object"===(void 0===t?"undefined":_typeof(t))?JSON.stringify(t,null,4):t},i=!0===Test.prototype.getResult(o,e,n);if(Test.prototype.hidePassed&&i)return null;var u=Test.prototype.output?{wrapperBegin:"<strong>",wrapperEnd:"</strong>",newLine:"<br>",separator:""}:{wrapperBegin:'"',wrapperEnd:'"',newLine:"\n >> ",separator:"-------------------------------------\n"},s="";o!==Test.ValidationFunction.EQUALS&&(s=" (using custom validation function)");var c,f=u.separator+"Testing: "+t+s+u.newLine;if(i?(f+="[âœ”] Passed!",c="#c8e6c9"):(f+="[âœ–] Failed. Expected "+u.wrapperBegin+r(e)+u.wrapperEnd+" ("+(void 0===e?"undefined":_typeof(e))+"), got "+u.wrapperBegin+r(n)+u.wrapperEnd+" ("+(void 0===n?"undefined":_typeof(n))+") instead.",c="#ff8a80"),Test.prototype.output){var l=document.createElement("div");Test.prototype.stylize(l,{"line-height":"1.5em",margin:"0.5em 0",padding:"0.5em",background:c}),l.insertAdjacentHTML("beforeend",f),f=l}return{result:f,passed:i,bgColor:c}},Test.prototype.stylize=function(t,e){Object.keys(e).forEach(function(n){t.style[n]=e[n]})},Test.config=function(){var t={};return t.output=function(t){t instanceof HTMLElement&&(Test.prototype.output=t)},t.hidePassed=function(t){Test.prototype.hidePassed=t,t&&console.warn("Passed tests are hidden!")},t.colorMethod=function(t){Test.prototype.colorMethod=t},t}(),"undefined"!=typeof module){Test.config.colorMethod(Test.Console.TERMINAL);var vm=require("vm"),inject=function(t,e){var n=t+"/"+e;vm.runInThisContext(fs.readFileSync(n,"utf8"),n)};module.exports={Test:Test,inject:inject}}